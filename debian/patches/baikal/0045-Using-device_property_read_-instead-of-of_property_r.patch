From d234c722e0fbedf7b0e683b611cfaa9e532534c5 Mon Sep 17 00:00:00 2001
From: Vitaly Miniakhmetov <vitalii.miniakhmetov@t-platforms.ru>
Date: Thu, 17 Jun 2021 11:02:33 +0500
Subject: [PATCH 045/106] Using device_property_read_*() instead of
 of_property_read_*()

---
 drivers/hwmon/pvt.c                   | 3 +--
 drivers/i2c/busses/i2c-baikal-smbus.c | 3 +--
 2 files changed, 2 insertions(+), 4 deletions(-)

diff --git a/drivers/hwmon/pvt.c b/drivers/hwmon/pvt.c
index c394d354e826..8258a223049a 100644
--- a/drivers/hwmon/pvt.c
+++ b/drivers/hwmon/pvt.c
@@ -537,7 +537,6 @@ static int pvt_probe(struct platform_device *pdev)
     unsigned int val, data;
     struct pvt_hwmon *hwmon;
     struct resource *mem;
-    struct device_node *np = pdev->dev.of_node;
 
     pr_debug("driver pvt_probe\n");
     hwmon = devm_kzalloc(&pdev->dev, sizeof(*hwmon), GFP_KERNEL);
@@ -548,7 +547,7 @@ static int pvt_probe(struct platform_device *pdev)
     hwmon->base = (int)mem->start;//devm_ioremap_resource(&pdev->dev, mem);
 
     /* Set PVT ID for secure monitor calls */
-    of_property_read_u32(np, "pvt_id", &(hwmon->pvt_id));
+    device_property_read_u32(&pdev->dev, "pvt_id", &(hwmon->pvt_id));
 
     hwmon->cell = mfd_get_cell(pdev);
     hwmon->irq = platform_get_irq(pdev, 0);
diff --git a/drivers/i2c/busses/i2c-baikal-smbus.c b/drivers/i2c/busses/i2c-baikal-smbus.c
index b834bd228214..6839cfa31fa3 100644
--- a/drivers/i2c/busses/i2c-baikal-smbus.c
+++ b/drivers/i2c/busses/i2c-baikal-smbus.c
@@ -342,7 +342,6 @@ static irqreturn_t be_smbus_isr(int irq, void *_dev)
 
 static int be_smbus_probe(struct platform_device *pdev)
 {
-	struct device_node *np = pdev->dev.of_node;
 	struct be_smbus_dev *besmb;
 	struct resource *res;
 	void __iomem *base;
@@ -375,7 +374,7 @@ static int be_smbus_probe(struct platform_device *pdev)
 	besmb->base = base;
 	besmb->dev = &pdev->dev;
 
-	of_property_read_u32(np, "clock-frequency", &besmb->bus_clk_rate);
+	device_property_read_u32(&pdev->dev, "clock-frequency", &besmb->bus_clk_rate);
 	if (!besmb->bus_clk_rate) {
 		besmb->bus_clk_rate = 100000; /* default clock rate */
 	}
-- 
2.33.0

