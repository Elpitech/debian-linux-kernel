From a1e56dadeea67d0aba28ffa915d32961254f6ddd Mon Sep 17 00:00:00 2001
From: Miniakhmetov Vitaly <vitalii.miniakhmetov@t-platforms.ru>
Date: Fri, 14 May 2021 17:36:54 +0500
Subject: [PATCH 035/106] Fixed TP EC tp_serio compat string in dts

---
 arch/arm64/boot/dts/baikal/bm-mbm.dtsi | 2 +-
 drivers/input/serio/tp_serio.c         | 4 ++++
 2 files changed, 5 insertions(+), 1 deletion(-)

diff --git a/arch/arm64/boot/dts/baikal/bm-mbm.dtsi b/arch/arm64/boot/dts/baikal/bm-mbm.dtsi
index d553b846d418..7e3c7eeadff6 100644
--- a/arch/arm64/boot/dts/baikal/bm-mbm.dtsi
+++ b/arch/arm64/boot/dts/baikal/bm-mbm.dtsi
@@ -99,7 +99,7 @@ eeprom@53 {
 	};
 
 	ps2port@54 {
-		compatible = "tp,tp_serio";
+		compatible = "tp,serio", "tp,tp_serio";
 		reg = <0x54>;
 		interrupt-parent = <&porta>;
 		interrupts = <14 8>;
diff --git a/drivers/input/serio/tp_serio.c b/drivers/input/serio/tp_serio.c
index f2b0f78ffaa4..1aaa2916b623 100644
--- a/drivers/input/serio/tp_serio.c
+++ b/drivers/input/serio/tp_serio.c
@@ -692,6 +692,10 @@ static void tp_serio_unregister(struct tp_serio_driver *driver)
 }
 
 static const struct of_device_id tp_serio_of_ids[] = {
+	{
+		.compatible = "tp,serio",
+	},
+	/* NOTE: The following stay here for backward compatibility */
 	{
 		.compatible = "tp,tp_serio",
 	},
-- 
2.33.0

