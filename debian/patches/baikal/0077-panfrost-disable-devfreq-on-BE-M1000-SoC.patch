From 39de9cb8f31258632a661733dfbfce07ec9129fb Mon Sep 17 00:00:00 2001
From: Vitaly Miniakhmetov <vitalii.miniakhmetov@t-platforms.ru>
Date: Fri, 2 Jul 2021 15:01:56 +0500
Subject: [PATCH 077/106] panfrost: disable devfreq on BE-M1000 SoC

---
 drivers/gpu/drm/panfrost/panfrost_devfreq.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/drivers/gpu/drm/panfrost/panfrost_devfreq.c b/drivers/gpu/drm/panfrost/panfrost_devfreq.c
index 3644652f726f..b5321d467a7d 100644
--- a/drivers/gpu/drm/panfrost/panfrost_devfreq.c
+++ b/drivers/gpu/drm/panfrost/panfrost_devfreq.c
@@ -92,6 +92,11 @@ int panfrost_devfreq_init(struct panfrost_device *pfdev)
 	struct thermal_cooling_device *cooling;
 	struct panfrost_devfreq *pfdevfreq = &pfdev->pfdevfreq;
 
+	if (of_device_is_compatible(of_root, "baikal,baikal-m")) {
+		DRM_DEV_INFO(dev, "disabling GPU devfreq on BE-M1000\n");
+		return 0;
+	}
+
 	if (pfdev->comp->num_supplies > 1) {
 		/*
 		 * GPUs with more than 1 supply require platform-specific handling:
-- 
2.33.0

